----QUIT----2025-10-13T17:06:49.115553+02:00 Pharo13.0-SNAPSHOT-64bit-3ff27d6817.image priorSource: 0!----QUIT----2025-10-13T17:06:49.117438+02:00 Pharo13.0-SNAPSHOT-64bit-3ff27d6817.image priorSource: 0!----QUIT----2025-10-13T17:07:11.217212+02:00 Pharo13.0-SNAPSHOT-64bit-3ff27d6817.image priorSource: 104!----QUIT----2025-10-13T17:07:11.218673+02:00 Pharo13.0-SNAPSHOT-64bit-3ff27d6817.image priorSource: 208!----QUIT----2025-10-13T17:07:11.787603+02:00 Pharo13.0-SNAPSHOT-64bit-3ff27d6817.image priorSource: 314!----QUIT----2025-10-13T17:07:11.788323+02:00 Pharo13.0-SNAPSHOT-64bit-3ff27d6817.image priorSource: 420!Object << #SnakePoint	slots: { #x . #y };	package: 'SnakeGame'!!SnakePoint methodsFor: 'nil' stamp: '2025-10-13T16:45:14.178-05:00'!initializeX: aX y: aY	x := aX.	y := aY! !!SnakePoint methodsFor: 'nil' stamp: '2025-10-13T16:45:25.758-05:00'!x	^ x! !!SnakePoint methodsFor: 'nil' stamp: '2025-10-13T16:46:38.375-05:00'!y	^ y! !!SnakePoint methodsFor: 'nil' stamp: '2025-10-13T16:46:50.537-05:00'!= aPoint	^ x = aPoint x and: [ y = aPoint y ]! !!SnakePoint methodsFor: 'nil' stamp: '2025-10-13T16:47:06.609-05:00'!hash	^ x hash bitXor: y hash! !Object << #Direction	slots: { #dx . #dy };	package: 'SnakeGame'!!Direction methodsFor: 'nil' stamp: '2025-10-13T16:53:56.633-05:00'!initializeDx: aDx dy: aDy	dx := aDx.	dy := aDy! !!Direction methodsFor: 'nil' stamp: '2025-10-13T16:54:07.651-05:00'!dx	^ dx! !!Direction methodsFor: 'nil' stamp: '2025-10-13T16:54:17.598-05:00'!dy	^ dy! !!Direction class methodsFor: 'nil' stamp: '2025-10-13T16:54:48.222-05:00'!up	^ self new initializeDx: 0 dy: -1! !!Direction class methodsFor: 'nil' stamp: '2025-10-13T16:55:00.221-05:00'!down	^ self new initializeDx: 0 dy: 1! !!Direction class methodsFor: 'nil' stamp: '2025-10-13T16:55:09.948-05:00'!left	^ self new initializeDx: -1 dy: 0! !!Direction class methodsFor: 'nil' stamp: '2025-10-13T16:55:20.498-05:00'!right	^ self new initializeDx: 1 dy: 0! !Object << #Snake	slots: { #body . #direction . #nextDirection . #growing };	package: 'SnakeGame'!!Snake methodsFor: 'nil' stamp: '2025-10-13T16:56:01.654-05:00'!initialize	super initialize.	body := OrderedCollection new.	body add: (SnakePoint new initializeX: 10 y: 10).	body add: (SnakePoint new initializeX: 9 y: 10).	body add: (SnakePoint new initializeX: 8 y: 10).	direction := Direction right.	nextDirection := direction.	growing := false! !!Snake methodsFor: 'nil' stamp: '2025-10-13T16:56:13.248-05:00'!body	^ body! !!Snake methodsFor: 'nil' stamp: '2025-10-13T16:56:39.42-05:00'!head	^ body first! !!Snake methodsFor: 'nil' stamp: '2025-10-13T16:56:53.779-05:00'!setDirection: aDirection	"Evita que la serpiente se mueva en dirección opuesta"	((aDirection dx + direction dx = 0) and: [ aDirection dy + direction dy = 0 ])		ifFalse: [ nextDirection := aDirection ]! !!Snake methodsFor: 'nil' stamp: '2025-10-13T16:57:05.22-05:00'!move	| newHead |	direction := nextDirection.	newHead := SnakePoint new		initializeX: self head x + direction dx		y: self head y + direction dy.	body addFirst: newHead.	growing ifFalse: [ body removeLast ].	growing := false! !!Snake methodsFor: 'nil' stamp: '2025-10-13T16:57:59.031-05:00'!grow	growing := true! !!Snake methodsFor: 'nil' stamp: '2025-10-13T16:58:10.691-05:00'!checkSelfCollision	| headPos |	headPos := self head.	^ body allButFirst anySatisfy: [ :segment | segment = headPos ]! !Object << #Food	slots: { #position };	package: 'SnakeGame'!!Food methodsFor: 'nil' stamp: '2025-10-13T16:58:41.361-05:00'!initializeAtX: aX y: aY	position := SnakePoint new initializeX: aX y: aY! !!Food methodsFor: 'nil' stamp: '2025-10-13T16:59:12.405-05:00'!position	^ position! !Object << #SnakeGame	slots: { #snake . #food . #score . #gameOver . #width . #height };	package: 'SnakeGame'!!SnakeGame methodsFor: 'nil' stamp: '2025-10-13T16:59:35.113-05:00'!initialize	super initialize.	width := 30.	height := 20.	score := 0.	gameOver := false.	snake := Snake new.	self spawnFood! !!SnakeGame methodsFor: 'nil' stamp: '2025-10-13T16:59:47.088-05:00'!spawnFood	| validPosition |	validPosition := false.	[ validPosition ] whileFalse: [		| x y pos |		x := (1 to: width) atRandom.		y := (1 to: height) atRandom.		pos := SnakePoint new initializeX: x y: y.		validPosition := (snake body noneSatisfy: [ :segment | segment = pos ]).		validPosition ifTrue: [ food := Food new initializeAtX: x y: y ] ]! !!SnakeGame methodsFor: 'nil' stamp: '2025-10-13T17:01:17.506-05:00'!update	gameOver ifTrue: [ ^ self ].	snake move.		"Verificar colisión con paredes"	(snake head x < 1 or: [ snake head x > width or: [ snake head y < 1 or: [ snake head y > height ] ] ])		ifTrue: [ gameOver := true. ^ self ].		"Verificar colisión consigo misma"	snake checkSelfCollision ifTrue: [ gameOver := true. ^ self ].		"Verificar colisión con comida"	(snake head = food position) ifTrue: [		snake grow.		score := score + 10.		self spawnFood ]! !!SnakeGame methodsFor: 'nil' stamp: '2025-10-13T17:01:28.604-05:00'!setDirection: aDirection	snake setDirection: aDirection! !!SnakeGame methodsFor: 'nil' stamp: '2025-10-13T17:01:38.135-05:00'!snake	^ snake! !!SnakeGame methodsFor: 'nil' stamp: '2025-10-13T17:01:45.585-05:00'!food	^ food! !!SnakeGame methodsFor: 'nil' stamp: '2025-10-13T17:01:59.879-05:00'!score	^ score! !!SnakeGame methodsFor: 'nil' stamp: '2025-10-13T17:02:09.242-05:00'!isGameOver	^ gameOver! !!SnakeGame methodsFor: 'nil' stamp: '2025-10-13T17:02:18.497-05:00'!width	^ width! !!SnakeGame methodsFor: 'nil' stamp: '2025-10-13T17:02:27.41-05:00'!height	^ height! !BorderedMorph << #SnakeGameMorph	slots: { #game . #cellSize . #stepTime };	package: 'SnakeGame'!!SnakeGameMorph methodsFor: 'nil' stamp: '2025-10-13T17:02:59.325-05:00'!initialize	super initialize.	game := SnakeGame new.	cellSize := 20.	stepTime := 150.	self extent: game width * cellSize @ (game height * cellSize + 40).	self color: Color black.	self startStepping! !!SnakeGameMorph methodsFor: 'nil' stamp: '2025-10-13T17:05:40.477-05:00'!drawOn: aCanvas	| foodRect scoreText |	super drawOn: aCanvas.		"Dibujar la serpiente"	game snake body do: [ :segment |		| rect |		rect := Rectangle			origin: (segment x - 1) * cellSize @ ((segment y - 1) * cellSize)			extent: cellSize @ cellSize.		rect := rect translateBy: self position.		aCanvas fillRectangle: rect color: Color green ].		"Dibujar la comida"	foodRect := Rectangle		origin: (game food position x - 1) * cellSize @ ((game food position y - 1) * cellSize)		extent: cellSize @ cellSize.	foodRect := foodRect translateBy: self position.	aCanvas fillRectangle: foodRect color: Color red.		"Dibujar el score"	scoreText := 'Score: ' , game score asString.	aCanvas		drawString: scoreText		at: self position + (10 @ (game height * cellSize + 10))		font: (LogicalFont familyName: 'Arial' pointSize: 16)		color: Color white.		"Dibujar Game Over"	game isGameOver ifTrue: [		| msg |		msg := 'GAME OVER - Presiona R para reiniciar'.		aCanvas			drawString: msg			at: self position + (50 @ (game height * cellSize // 2))			font: (LogicalFont familyName: 'Arial' pointSize: 14)			color: Color yellow ]! !!SnakeGameMorph methodsFor: 'nil' stamp: '2025-10-13T17:05:53.319-05:00'!step	game isGameOver ifFalse: [		game update.		self changed ]! !!SnakeGameMorph methodsFor: 'nil' stamp: '2025-10-13T17:06:02.681-05:00'!stepTime	^ stepTime! !!SnakeGameMorph methodsFor: 'nil' stamp: '2025-10-13T17:06:19.523-05:00'!handlesKeyboard: evt	^ true! !!SnakeGameMorph methodsFor: 'nil' stamp: '2025-10-13T17:06:30.082-05:00'!keyStroke: evt	evt keyCharacter = $w ifTrue: [ game setDirection: Direction up ].	evt keyCharacter = $s ifTrue: [ game setDirection: Direction down ].	evt keyCharacter = $a ifTrue: [ game setDirection: Direction left ].	evt keyCharacter = $d ifTrue: [ game setDirection: Direction right ].	evt keyCharacter = $r ifTrue: [		game isGameOver ifTrue: [			game := SnakeGame new.			self changed ] ]! !!SnakeGame methodsFor: 'initialization' stamp: '2025-10-13T17:12:31.143-05:00' prior: 7935!initialize	super initialize.	width := 30.	height := 30.	score := 0.	gameOver := false.	snake := Snake new.	self spawnFood! !!SnakeGame methodsFor: 'initialization' stamp: '2025-10-13T17:13:04.575-05:00' prior: 16469!initialize	super initialize.	width := 30.	height := 20.	score := 0.	gameOver := false.	snake := Snake new.	self spawnFood! !!SnakeGameMorph methodsFor: 'initialization' stamp: '2025-10-13T17:16:41.762-05:00' prior: 11791!initialize	super initialize.	game := SnakeGame new.	cellSize := 20.	stepTime := 150.	self extent: game width * cellSize @ (game height * cellSize).	self color: Color black.	self borderWidth: 2.	self borderColor: Color white.	self startStepping! !!SnakeGameMorph methodsFor: 'drawing' stamp: '2025-10-13T17:17:01.378-05:00' prior: 12353!drawOn: aCanvas	| foodRect scoreText |	super drawOn: aCanvas.		"Dibujar la serpiente"	game snake body do: [ :segment |		| rect |		rect := Rectangle			origin: (segment x - 1) * cellSize @ ((segment y - 1) * cellSize)			extent: cellSize @ cellSize.		rect := rect translateBy: self position.		aCanvas fillRectangle: rect color: Color green ].		"Dibujar la comida"	foodRect := Rectangle		origin: (game food position x - 1) * cellSize @ ((game food position y - 1) * cellSize)		extent: cellSize @ cellSize.	foodRect := foodRect translateBy: self position.	aCanvas fillRectangle: foodRect color: Color red.		"Dibujar el score en la esquina superior izquierda"	scoreText := 'Score: ' , game score asString.	aCanvas		drawString: scoreText		at: self position + (10 @ 10)		font: (LogicalFont familyName: 'Arial' pointSize: 14)		color: Color yellow.		"Dibujar Game Over en el centro"	game isGameOver ifTrue: [		| msg msgWidth msgHeight centerX centerY |		msg := 'GAME OVER - Presiona R para reiniciar'.		msgWidth := 300.		msgHeight := 20.		centerX := (game width * cellSize - msgWidth) // 2.		centerY := (game height * cellSize - msgHeight) // 2.		aCanvas			drawString: msg			at: self position + (centerX @ centerY)			font: (LogicalFont familyName: 'Arial' pointSize: 14)			color: Color yellow ]! !----SNAPSHOT----2025-10-13T17:19:35.691-05:00 Prueba01.image priorSource: 526!----SNAPSHOT----2025-10-13T17:19:35.755-05:00 Prueba01.image priorSource: 10363!----SNAPSHOT----2025-10-13T17:19:40.591-05:00 Prueba01.image priorSource: 10443!----SNAPSHOT----2025-10-13T17:19:40.618-05:00 Prueba01.image priorSource: 10525!----QUIT----2025-10-13T17:19:48.534-05:00 Prueba01.image priorSource: 10607!----QUIT----2025-10-13T17:19:48.622-05:00 Prueba01.image priorSource: 10689!----QUIT----2025-10-13T21:48:25.543-05:00 Prueba01.image priorSource: 10767!----QUIT----2025-10-13T21:48:25.574-05:00 Prueba01.image priorSource: 10845!!SnakePoint methodsFor: 'comparing' stamp: '2025-10-13T22:18:19.972-05:00' prior: 2089!= aPoint	^ x = aPoint x and: [ y = aPoint y ]! !!Snake methodsFor: 'initialization' stamp: '2025-10-13T22:21:40.08-05:00' prior: 4367!initialize	super initialize.	body := OrderedCollection new.	self resetToPosition: 10 @ 10! !!Snake methodsFor: 'nil' stamp: '2025-10-13T22:21:51.263-05:00'!resetToPosition: aPoint	body := OrderedCollection new.	body add: (SnakePoint new initializeX: aPoint x y: aPoint y).	body add: (SnakePoint new initializeX: aPoint x - 1 y: aPoint y).	body add: (SnakePoint new initializeX: aPoint x - 2 y: aPoint y).	direction := Direction right.	nextDirection := direction.	growing := false! !!Snake methodsFor: 'nil' stamp: '2025-10-13T22:22:37.728-05:00'!length	^ body size! !Object << #Level	slots: { #levelNumber . #width . #height . #obstacles . #foodRequired . #speed . #name };	package: 'SnakeGame'!!Level methodsFor: 'nil' stamp: '2025-10-13T22:23:34.431-05:00'!initializeLevel: aNumber	levelNumber := aNumber.	width := 30.	height := 20.	obstacles := Set new.	self buildLevel! !!Level methodsFor: 'nil' stamp: '2025-10-13T22:23:44.265-05:00'!buildLevel	levelNumber = 1 ifTrue: [ self buildLevel1 ].	levelNumber = 2 ifTrue: [ self buildLevel2 ].	levelNumber = 3 ifTrue: [ self buildLevel3 ].	levelNumber = 4 ifTrue: [ self buildLevel4 ].	levelNumber = 5 ifTrue: [ self buildLevel5 ]! !!Level methodsFor: 'nil' stamp: '2025-10-13T22:23:54.01-05:00'!buildLevel1	name := 'Level 1 - Empty Field'.	foodRequired := 5.	speed := 150.	"Sin obstáculos"! !!Level methodsFor: 'nil' stamp: '2025-10-13T22:24:07.237-05:00'!buildLevel2	name := 'Level 2 - The Cross'.	foodRequired := 8.	speed := 130.	"Cruz en el centro"	10 to: 20 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 10) ].	6 to: 14 do: [ :y |		obstacles add: (SnakePoint new initializeX: 15 y: y) ]! !!Level methodsFor: 'nil' stamp: '2025-10-13T22:24:20.513-05:00'!buildLevel3	name := 'Level 3 - The Boxes'.	foodRequired := 10.	speed := 110.	"Cajas en las esquinas"	5 to: 8 do: [ :x |		5 to: 8 do: [ :y |			obstacles add: (SnakePoint new initializeX: x y: y) ] ].	22 to: 25 do: [ :x |		5 to: 8 do: [ :y |			obstacles add: (SnakePoint new initializeX: x y: y) ] ].	5 to: 8 do: [ :x |		13 to: 16 do: [ :y |			obstacles add: (SnakePoint new initializeX: x y: y) ] ].	22 to: 25 do: [ :x |		13 to: 16 do: [ :y |			obstacles add: (SnakePoint new initializeX: x y: y) ] ]! !!Level methodsFor: 'nil' stamp: '2025-10-13T22:24:30.247-05:00'!buildLevel4	name := 'Level 4 - The Maze'.	foodRequired := 12.	speed := 90.	"Laberinto parcial"	8 to: 22 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 6) ].	8 to: 22 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 14) ].	6 to: 14 do: [ :y |		obstacles add: (SnakePoint new initializeX: 8 y: y) ].	6 to: 14 do: [ :y |		obstacles add: (SnakePoint new initializeX: 22 y: y) ]! !!Level methodsFor: 'nil' stamp: '2025-10-13T22:24:45.353-05:00'!buildLevel5	name := 'Level 5 - The Spiral'.	foodRequired := 15.	speed := 70.	"Espiral"	5 to: 25 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 5) ].	5 to: 25 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 15) ].	5 to: 15 do: [ :y |		obstacles add: (SnakePoint new initializeX: 5 y: y) ].	5 to: 15 do: [ :y |		obstacles add: (SnakePoint new initializeX: 25 y: y) ].	10 to: 20 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 8) ].	10 to: 20 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 12) ].	8 to: 12 do: [ :y |		obstacles add: (SnakePoint new initializeX: 10 y: y) ].	8 to: 12 do: [ :y |		obstacles add: (SnakePoint new initializeX: 20 y: y) ]! !!Level methodsFor: 'nil' stamp: '2025-10-13T22:25:00.587-05:00'!hasObstacleAt: aPoint	^ obstacles includes: aPoint! !!Level methodsFor: 'nil' stamp: '2025-10-13T22:25:08.437-05:00'!width	^ width! !!Level methodsFor: 'nil' stamp: '2025-10-13T22:25:15.782-05:00'!height	^ height! !!Level methodsFor: 'nil' stamp: '2025-10-13T22:25:26.545-05:00'!obstacles	^ obstacles! !!Level methodsFor: 'nil' stamp: '2025-10-13T22:25:37.525-05:00'!foodRequired	^ foodRequired! !!Level methodsFor: 'nil' stamp: '2025-10-13T22:25:47.062-05:00'!speed	^ speed! !!Level methodsFor: 'nil' stamp: '2025-10-13T22:25:54.83-05:00'!name	^ name! !Object << #SnakeGame	slots: { #snake . #food . #score . #gameOver . #currentLevel . #level . #foodEaten . #won };	package: 'SnakeGame'!!SnakeGame methodsFor: 'initialization' stamp: '2025-10-13T22:26:34.227-05:00' prior: 16919!initialize	super initialize.	currentLevel := 1.	score := 0.	gameOver := false.	won := false.	foodEaten := 0.	self loadLevel: currentLevel! !!SnakeGame methodsFor: 'nil' stamp: '2025-10-13T22:26:46.986-05:00'!loadLevel: levelNumber	level := Level new initializeLevel: levelNumber.	snake := Snake new.	snake resetToPosition: 10 @ 10.	foodEaten := 0.	self spawnFood! !!SnakeGame methodsFor: 'as yet unclassified' stamp: '2025-10-13T22:27:00.382-05:00' prior: 8337!spawnFood	| validPosition |	validPosition := false.	[ validPosition ] whileFalse: [		| x y pos |		x := (1 to: level width) atRandom.		y := (1 to: level height) atRandom.		pos := SnakePoint new initializeX: x y: y.		validPosition := (snake body noneSatisfy: [ :segment | segment = pos ])			and: [ (level hasObstacleAt: pos) not ].		validPosition ifTrue: [ food := Food new initializeAtX: x y: y ] ]! !!SnakeGame methodsFor: 'updating' stamp: '2025-10-13T22:27:14.448-05:00' prior: 9189!update	gameOver ifTrue: [ ^ self ].	won ifTrue: [ ^ self ].		snake move.		"Verificar colisión con paredes"	(snake head x < 1 or: [ snake head x > level width or:		[ snake head y < 1 or: [ snake head y > level height ] ] ])		ifTrue: [ gameOver := true. ^ self ].		"Verificar colisión con obstáculos"	(level hasObstacleAt: snake head) ifTrue: [		gameOver := true.		^ self ].		"Verificar colisión consigo misma"	snake checkSelfCollision ifTrue: [ gameOver := true. ^ self ].		"Verificar colisión con comida"	(snake head = food position) ifTrue: [		snake grow.		score := score + 10.		foodEaten := foodEaten + 1.				"Verificar si pasa de nivel"		foodEaten >= level foodRequired ifTrue: [			currentLevel := currentLevel + 1.			currentLevel > 5				ifTrue: [ won := true ]				ifFalse: [ self loadLevel: currentLevel ] ]		ifFalse: [ self spawnFood ] ]! !!SnakeGame methodsFor: 'initialization' stamp: '2025-10-13T22:27:25.655-05:00' prior: 10265!setDirection: aDirection	snake setDirection: aDirection! !!SnakeGame methodsFor: 'nil' stamp: '2025-10-13T22:28:16.213-05:00'!hasWon	^ won! !!SnakeGame methodsFor: 'nil' stamp: '2025-10-13T22:28:27.233-05:00'!level	^ level! !!SnakeGame methodsFor: 'nil' stamp: '2025-10-13T22:28:36.278-05:00'!currentLevel	^ currentLevel! !!SnakeGame methodsFor: 'nil' stamp: '2025-10-13T22:28:49.21-05:00'!foodEaten	^ foodEaten! !!SnakeGame methodsFor: 'accessing' stamp: '2025-10-13T22:31:35.245-05:00' prior: 11231!width	^ level width! !!SnakeGame methodsFor: 'accessing' stamp: '2025-10-13T22:31:41.049-05:00' prior: 11403!height	^ level height! !!SnakeGameMorph methodsFor: 'initialization' stamp: '2025-10-13T22:32:14.746-05:00' prior: 17379!initialize	super initialize.	game := SnakeGame new.	cellSize := 20.	self updateStepTime.	self extent: game level width * cellSize @ (game level height * cellSize + 60).	self color: Color black.	self borderWidth: 2.	self borderColor: Color white.	self startStepping! !!SnakeGameMorph methodsFor: 'nil' stamp: '2025-10-13T22:32:25.768-05:00'!updateStepTime	stepTime := game level speed! !!SnakeGameMorph methodsFor: 'drawing' stamp: '2025-10-13T22:34:09.78-05:00' prior: 18073!drawOn: aCanvas	| scoreText levelText foodText foodRect |	super drawOn: aCanvas.		"Dibujar obstáculos"	game level obstacles do: [ :obstacle |		| rect |		rect := Rectangle			origin: (obstacle x - 1) * cellSize @ ((obstacle y - 1) * cellSize)			extent: cellSize @ cellSize.		rect := rect translateBy: self position.		aCanvas fillRectangle: rect color: Color gray ].		"Dibujar la serpiente"	game snake body doWithIndex: [ :segment :index |		| rect color |		rect := Rectangle			origin: (segment x - 1) * cellSize @ ((segment y - 1) * cellSize)			extent: cellSize @ cellSize.		rect := rect translateBy: self position.		color := index = 1			ifTrue: [ Color yellow ]			ifFalse: [ Color green ].		aCanvas fillRectangle: rect color: color ].		"Dibujar la comida"	foodRect := Rectangle		origin: (game food position x - 1) * cellSize @ ((game food position y - 1) * cellSize)		extent: cellSize @ cellSize.	foodRect := foodRect translateBy: self position.	aCanvas fillRectangle: foodRect color: Color red.		"Dibujar HUD"	scoreText := 'Score: ' , game score asString.	levelText := '  Level: ' , game currentLevel asString.	foodText := '  Food: ' , game foodEaten asString , '/' , game level foodRequired asString.		aCanvas		drawString: scoreText , levelText , foodText		at: self position + (10 @ (game level height * cellSize + 10))		font: (LogicalFont familyName: 'Arial' pointSize: 14)		color: Color white.		"Nombre del nivel"	aCanvas		drawString: game level name		at: self position + (10 @ (game level height * cellSize + 30))		font: (LogicalFont familyName: 'Arial' pointSize: 12)		color: Color cyan.		"Dibujar Game Over"	game isGameOver ifTrue: [		| msg |		msg := 'GAME OVER - Press R to restart'.		aCanvas			drawString: msg			at: self position + (50 @ (game level height * cellSize // 2))			font: (LogicalFont familyName: 'Arial' pointSize: 14)			color: Color yellow ].		"Dibujar Victoria"	game hasWon ifTrue: [		| msg |		msg := 'YOU WIN!! All levels completed!!'.		aCanvas			drawString: msg			at: self position + (40 @ (game level height * cellSize // 2))			font: (LogicalFont familyName: 'Arial' pointSize: 14)			color: Color green ]! !!SnakeGameMorph methodsFor: 'stepping and presenter' stamp: '2025-10-13T22:34:19.582-05:00' prior: 14785!step	(game isGameOver not and: [ game hasWon not ]) ifTrue: [		game update.		self updateStepTime.		self changed ]! !!SnakeGameMorph methodsFor: 'stepping and presenter' stamp: '2025-10-13T22:34:27.951-05:00' prior: 15069!stepTime	^ stepTime! !!SnakeGameMorph methodsFor: 'event handling' stamp: '2025-10-13T22:34:47.749-05:00' prior: 15477!keyStroke: evt	evt keyCharacter = $w ifTrue: [ game setDirection: Direction up ].	evt keyCharacter = $s ifTrue: [ game setDirection: Direction down ].	evt keyCharacter = $a ifTrue: [ game setDirection: Direction left ].	evt keyCharacter = $d ifTrue: [ game setDirection: Direction right ].	evt keyCharacter = $r ifTrue: [		(game isGameOver or: [ game hasWon ]) ifTrue: [			game := SnakeGame new.			self updateStepTime.			self changed ] ]! !!Level methodsFor: 'as yet unclassified' stamp: '2025-10-13T22:42:04.726-05:00' prior: 25349!buildLevel2	name := 'Level 2 - The Cross'.	foodRequired := 8.	speed := 130.	"Cruz en el centro - con huecos"	10 to: 13 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 10) ].	17 to: 20 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 10) ].	6 to: 8 do: [ :y |		obstacles add: (SnakePoint new initializeX: 15 y: y) ].	12 to: 14 do: [ :y |		obstacles add: (SnakePoint new initializeX: 15 y: y) ]! !!Level methodsFor: 'as yet unclassified' stamp: '2025-10-13T22:42:31.259-05:00' prior: 27169!buildLevel4	name := 'Level 4 - The Maze'.	foodRequired := 12.	speed := 90.	"Laberinto con aberturas"	8 to: 12 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 6) ].	18 to: 22 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 6) ].	8 to: 12 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 14) ].	18 to: 22 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 14) ].	6 to: 10 do: [ :y |		obstacles add: (SnakePoint new initializeX: 8 y: y) ].	10 to: 14 do: [ :y |		obstacles add: (SnakePoint new initializeX: 22 y: y) ]! !!Level methodsFor: 'as yet unclassified' stamp: '2025-10-13T22:42:48.259-05:00' prior: 28129!buildLevel5	name := 'Level 5 - The Spiral'.	foodRequired := 15.	speed := 70.	"Espiral con aberturas"	5 to: 25 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 5) ].	5 to: 10 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 15) ].	20 to: 25 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 15) ].	5 to: 15 do: [ :y |		obstacles add: (SnakePoint new initializeX: 5 y: y) ].	5 to: 10 do: [ :y |		obstacles add: (SnakePoint new initializeX: 25 y: y) ].	12 to: 15 do: [ :y |		obstacles add: (SnakePoint new initializeX: 25 y: y) ].	10 to: 20 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 8) ].	10 to: 15 do: [ :x |		obstacles add: (SnakePoint new initializeX: x y: 12) ].	8 to: 12 do: [ :y |		obstacles add: (SnakePoint new initializeX: 10 y: y) ].	8 to: 10 do: [ :y |		obstacles add: (SnakePoint new initializeX: 20 y: y) ]! !!Level methodsFor: 'nil' stamp: '2025-10-13T22:43:01.717-05:00'!getStartPosition	levelNumber = 1 ifTrue: [ ^ 10 @ 10 ].	levelNumber = 2 ifTrue: [ ^ 5 @ 5 ].	levelNumber = 3 ifTrue: [ ^ 15 @ 10 ].	levelNumber = 4 ifTrue: [ ^ 15 @ 10 ].	levelNumber = 5 ifTrue: [ ^ 15 @ 10 ].	^ 10 @ 10! !!SnakeGame methodsFor: 'as yet unclassified' stamp: '2025-10-13T22:43:24.945-05:00' prior: 31755!loadLevel: levelNumber	level := Level new initializeLevel: levelNumber.	snake := Snake new.	snake resetToPosition: level getStartPosition.	foodEaten := 0.	self spawnFood! !!SnakeGameMorph methodsFor: 'initialization' stamp: '2025-10-13T22:49:10.922-05:00' prior: 36725!initialize	super initialize.	game := SnakeGame new.	cellSize := 20.	self updateStepTime.	self extent: game level width * cellSize @ (game level height * cellSize + 60).	self color: Color black.	self borderWidth: 2.	self borderColor: Color white.	self startStepping! !!SnakeGameMorph methodsFor: 'drawing' stamp: '2025-10-13T22:51:07.702-05:00' prior: 37703!drawOn: aCanvas	| scoreText levelText foodText foodRect |	super drawOn: aCanvas.		"Dibujar obstáculos"	game level obstacles do: [ :obstacle |		| rect |		rect := Rectangle			origin: (obstacle x - 1) * cellSize @ ((obstacle y - 1) * cellSize)			extent: cellSize @ cellSize.		rect := rect translateBy: self position.		aCanvas fillRectangle: rect color: Color gray ].		"Dibujar la serpiente"	game snake body doWithIndex: [ :segment :index |		| rect color |		rect := Rectangle			origin: (segment x - 1) * cellSize @ ((segment y - 1) * cellSize)			extent: cellSize @ cellSize.		rect := rect translateBy: self position.		color := index = 1			ifTrue: [ Color yellow ]			ifFalse: [ Color green ].		aCanvas fillRectangle: rect color: color ].		"Dibujar la comida"	foodRect := Rectangle		origin: (game food position x - 1) * cellSize @ ((game food position y - 1) * cellSize)		extent: cellSize @ cellSize.	foodRect := foodRect translateBy: self position.	aCanvas fillRectangle: foodRect color: Color red.		"Dibujar HUD"	scoreText := 'Score: ' , game score asString.	levelText := '  Level: ' , game currentLevel asString.	foodText := '  Food: ' , game foodEaten asString , '/' , game level foodRequired asString.		aCanvas		drawString: scoreText , levelText , foodText		at: self position + (10 @ (game level height * cellSize + 10))		font: (LogicalFont familyName: 'Arial' pointSize: 14)		color: Color white.		"Nombre del nivel"	aCanvas		drawString: game level name		at: self position + (10 @ (game level height * cellSize + 30))		font: (LogicalFont familyName: 'Arial' pointSize: 12)		color: Color cyan.		"Dibujar Game Over"	game isGameOver ifTrue: [		| msg |		msg := 'GAME OVER - Press R to restart'.		aCanvas			drawString: msg			at: self position + (50 @ (game level height * cellSize // 2))			font: (LogicalFont familyName: 'Arial' pointSize: 14)			color: Color yellow ].		"Dibujar Victoria"	game hasWon ifTrue: [		| msg |		msg := 'YOU WIN!! All levels completed!!'.		aCanvas			drawString: msg			at: self position + (40 @ (game level height * cellSize // 2))			font: (LogicalFont familyName: 'Arial' pointSize: 14)			color: Color green ]! !!SnakeGame methodsFor: 'updating' stamp: '2025-10-13T22:53:28.992-05:00' prior: 33271!update	gameOver ifTrue: [ ^ self ].	won ifTrue: [ ^ self ].		snake move.		"Verificar colisión con paredes del área de juego"	(snake head x < 1 or: [ snake head x > level width or:		[ snake head y < 1 or: [ snake head y > level height ] ] ])		ifTrue: [ gameOver := true. ^ self ].		"Verificar colisión con obstáculos"	(level hasObstacleAt: snake head) ifTrue: [		gameOver := true.		^ self ].		"Verificar colisión consigo misma"	snake checkSelfCollision ifTrue: [ gameOver := true. ^ self ].		"Verificar colisión con comida"	(snake head = food position) ifTrue: [		snake grow.		score := score + 10.		foodEaten := foodEaten + 1.				"Verificar si pasa de nivel"		foodEaten >= level foodRequired ifTrue: [			currentLevel := currentLevel + 1.			currentLevel > 5				ifTrue: [ won := true ]				ifFalse: [ self loadLevel: currentLevel ] ]		ifFalse: [ self spawnFood ] ]! !!Level methodsFor: 'initialization' stamp: '2025-10-13T22:54:02.723-05:00' prior: 24015!initializeLevel: aNumber	levelNumber := aNumber.	width := 30.	height := 20.	obstacles := Set new.	self buildLevel! !!Level methodsFor: 'initialization' stamp: '2025-10-13T22:57:00.981-05:00' prior: 56933!initializeLevel: aNumber	levelNumber := aNumber.	width := 30.	height := 22.	obstacles := Set new.	self buildLevel! !!SnakeGameMorph methodsFor: 'initialization' stamp: '2025-10-13T22:58:43.192-05:00' prior: 49641!initialize	super initialize.	game := SnakeGame new.	cellSize := 20.	self updateStepTime.	self extent: game level width * cellSize @ (game level height * cellSize).	self color: Color black.	self borderWidth: 2.	self borderColor: Color white.	self startStepping! !!SnakeGameMorph methodsFor: 'initialization' stamp: '2025-10-13T22:59:02.044-05:00' prior: 57795!initialize	super initialize.	game := SnakeGame new.	cellSize := 20.	self updateStepTime.	self extent: game level width * cellSize @ (game level height * cellSize).	self color: Color black.	self borderWidth: 2.	self borderColor: Color white.	self startStepping! !!SnakeGameMorph methodsFor: 'drawing' stamp: '2025-10-13T23:04:12.878-05:00' prior: 50377!drawOn: aCanvas	| scoreText levelText foodText hudHeight hudRect foodRect |	super drawOn: aCanvas.		"Dibujar obstáculos"	game level obstacles do: [ :obstacle |		| rect |		rect := Rectangle			origin: (obstacle x - 1) * cellSize @ ((obstacle y - 1) * cellSize)			extent: cellSize @ cellSize.		rect := rect translateBy: self position.		aCanvas fillRectangle: rect color: Color gray ].		"Dibujar la serpiente"	game snake body doWithIndex: [ :segment :index |		| rect color |		rect := Rectangle			origin: (segment x - 1) * cellSize @ ((segment y - 1) * cellSize)			extent: cellSize @ cellSize.		rect := rect translateBy: self position.		color := index = 1			ifTrue: [ Color yellow ]			ifFalse: [ Color green ].		aCanvas fillRectangle: rect color: color ].		"Dibujar la comida"	foodRect := Rectangle		origin: (game food position x - 1) * cellSize @ ((game food position y - 1) * cellSize)		extent: cellSize @ cellSize.	foodRect := foodRect translateBy: self position.	aCanvas fillRectangle: foodRect color: Color red.		"Dibujar fondo del HUD"	hudHeight := 50.	hudRect := Rectangle		origin: self position x @ (self position y + (game level height * cellSize) - hudHeight)		extent: (game level width * cellSize) @ hudHeight.	aCanvas fillRectangle: hudRect color: (Color black alpha: 0.7).		"Dibujar HUD"	scoreText := 'Score: ' , game score asString.	levelText := '  Level: ' , game currentLevel asString.	foodText := '  Food: ' , game foodEaten asString , '/' , game level foodRequired asString.		aCanvas		drawString: scoreText , levelText , foodText		at: self position + (10 @ (game level height * cellSize - 40))		font: (LogicalFont familyName: 'Arial' pointSize: 14)		color: Color white.		"Nombre del nivel"	aCanvas		drawString: game level name		at: self position + (10 @ (game level height * cellSize - 20))		font: (LogicalFont familyName: 'Arial' pointSize: 12)		color: Color cyan.		"Dibujar Game Over"	game isGameOver ifTrue: [		| msg |		msg := 'GAME OVER - Press R to restart'.		aCanvas			drawString: msg			at: self position + (50 @ (game level height * cellSize // 2))			font: (LogicalFont familyName: 'Arial' pointSize: 14)			color: Color yellow ].		"Dibujar Victoria"	game hasWon ifTrue: [		| msg |		msg := 'YOU WIN!! All levels completed!!'.		aCanvas			drawString: msg			at: self position + (40 @ (game level height * cellSize // 2))			font: (LogicalFont familyName: 'Arial' pointSize: 14)			color: Color green ]! !!SnakeGame methodsFor: 'initialization' stamp: '2025-10-13T23:12:35.648-05:00' prior: 31321!initialize	super initialize.	currentLevel := 5.	score := 0.	gameOver := false.	won := false.	foodEaten := 0.	self loadLevel: currentLevel! !!SnakeGame methodsFor: 'initialization' stamp: '2025-10-13T23:13:18.166-05:00' prior: 64437!initialize	super initialize.	currentLevel := 1.	score := 0.	gameOver := false.	won := false.	foodEaten := 0.	self loadLevel: currentLevel! !